# mapeo de carpetas con su respectiva clase usando 82 clases
classes_level1 = {
 'Akarna_Dhanurasana': 0,
 "Bharadvaja's_Twist_pose_or_Bharadvajasana_I_": 1,
 'Boat_Pose_or_Paripurna_Navasana_': 2,
 'Bound_Angle_Pose_or_Baddha_Konasana_': 3,
 'Bow_Pose_or_Dhanurasana_': 4,
 'Bridge_Pose_or_Setu_Bandha_Sarvangasana_': 5,
 'Camel_Pose_or_Ustrasana_': 6,
 'Cat_Cow_Pose_or_Marjaryasana_': 7,
 'Chair_Pose_or_Utkatasana_': 8,
 'Child_Pose_or_Balasana_': 9,
 'Cobra_Pose_or_Bhujangasana_': 10,
 'Cockerel_Pose': 11,
 'Corpse_Pose_or_Savasana_': 12,
 'Cow_Face_Pose_or_Gomukhasana_': 13,
 'Crane_(Crow)_Pose_or_Bakasana_': 14,
 'Dolphin_Plank_Pose_or_Makara_Adho_Mukha_Svanasana_': 15,
 'Dolphin_Pose_or_Ardha_Pincha_Mayurasana_': 16,
 'Downward-Facing_Dog_pose_or_Adho_Mukha_Svanasana_': 17,
 'Eagle_Pose_or_Garudasana_': 18,
 'Eight-Angle_Pose_or_Astavakrasana_': 19,
 'Extended_Puppy_Pose_or_Uttana_Shishosana_': 20,
 'Extended_Revolved_Side_Angle_Pose_or_Utthita_Parsvakonasana_': 21,
 'Extended_Revolved_Triangle_Pose_or_Utthita_Trikonasana_': 22,
 'Feathered_Peacock_Pose_or_Pincha_Mayurasana_': 23,
 'Firefly_Pose_or_Tittibhasana_': 24,
 'Fish_Pose_or_Matsyasana_': 25,
 'Four-Limbed_Staff_Pose_or_Chaturanga_Dandasana_': 26,
 'Frog_Pose_or_Bhekasana': 27,
 'Garland_Pose_or_Malasana_': 28,
 'Gate_Pose_or_Parighasana_': 29,
 'Half_Lord_of_the_Fishes_Pose_or_Ardha_Matsyendrasana_': 30,
 'Half_Moon_Pose_or_Ardha_Chandrasana_': 31,
 'Handstand_pose_or_Adho_Mukha_Vrksasana_': 32,
 'Happy_Baby_Pose_or_Ananda_Balasana_': 33,
 'Head-to-Knee_Forward_Bend_pose_or_Janu_Sirsasana_': 34,
 'Heron_Pose_or_Krounchasana_': 35,
 'Intense_Side_Stretch_Pose_or_Parsvottanasana_': 36,
 'Legs-Up-the-Wall_Pose_or_Viparita_Karani_': 37,
 'Locust_Pose_or_Salabhasana_': 38,
 'Lord_of_the_Dance_Pose_or_Natarajasana_': 39,
 'Low_Lunge_pose_or_Anjaneyasana_': 40,
 'Noose_Pose_or_Pasasana_': 41,
 'Peacock_Pose_or_Mayurasana_': 42,
 'Pigeon_Pose_or_Kapotasana_': 43,
 'Plank_Pose_or_Kumbhakasana_': 44,
 'Plow_Pose_or_Halasana_': 45,
 'Pose_Dedicated_to_the_Sage_Koundinya_or_Eka_Pada_Koundinyanasana_I_and_II': 46,
 'Rajakapotasana': 47,
 'Reclining_Hand-to-Big-Toe_Pose_or_Supta_Padangusthasana_': 48,
 'Revolved_Head-to-Knee_Pose_or_Parivrtta_Janu_Sirsasana_': 49,
 'Scale_Pose_or_Tolasana_': 50,
 'Scorpion_pose_or_vrischikasana': 51,
 'Seated_Forward_Bend_pose_or_Paschimottanasana_': 52,
 'Shoulder-Pressing_Pose_or_Bhujapidasana_': 53,
 'Side-Reclining_Leg_Lift_pose_or_Anantasana_': 54,
 'Side_Crane_(Crow)_Pose_or_Parsva_Bakasana_': 55,
 'Side_Plank_Pose_or_Vasisthasana_': 56,
 'Sitting pose 1 (normal)': 57,
 'Split pose': 58,
 'Staff_Pose_or_Dandasana_': 59,
 'Standing_Forward_Bend_pose_or_Uttanasana_': 60,
 'Standing_Split_pose_or_Urdhva_Prasarita_Eka_Padasana_': 61,
 'Standing_big_toe_hold_pose_or_Utthita_Padangusthasana': 62,
 'Supported_Headstand_pose_or_Salamba_Sirsasana_': 63,
 'Supported_Shoulderstand_pose_or_Salamba_Sarvangasana_': 64,
 'Supta_Baddha_Konasana_': 65,
 'Supta_Virasana_Vajrasana': 66,
 'Tortoise_Pose': 67,
 'Tree_Pose_or_Vrksasana_': 68,
 'Upward_Bow_(Wheel)_Pose_or_Urdhva_Dhanurasana_': 69,
 'Upward_Facing_Two-Foot_Staff_Pose_or_Dwi_Pada_Viparita_Dandasana_': 70,
 'Upward_Plank_Pose_or_Purvottanasana_': 71,
 'Virasana_or_Vajrasana': 72,
 'Warrior_III_Pose_or_Virabhadrasana_III_': 73,
 'Warrior_II_Pose_or_Virabhadrasana_II_': 74,
 'Warrior_I_Pose_or_Virabhadrasana_I_': 75,
 'Wide-Angle_Seated_Forward_Bend_pose_or_Upavistha_Konasana_': 76,
 'Wide-Legged_Forward_Bend_pose_or_Prasarita_Padottanasana_': 77,
 'Wild_Thing_pose_or_Camatkarasana_': 78,
 'Wind_Relieving_pose_or_Pawanmuktasana': 79,
 'Yogic_sleep_pose': 80,
 'viparita_virabhadrasana_or_reverse_warrior_pose': 81}

# mapeo de carpetas con su respectiva clase usando 20 clases
classes_level2 = {
# standing
'Eagle_Pose_or_Garudasana_': 0, 
'Tree_Pose_or_Vrksasana_': 0,
'Chair_Pose_or_Utkatasana_': 0,
                  
'Standing_Forward_Bend_pose_or_Uttanasana_': 1,
'Wide-Legged_Forward_Bend_pose_or_Prasarita_Padottanasana_': 1,
'Dolphin_Pose_or_Ardha_Pincha_Mayurasana_': 1,
'Downward-Facing_Dog_pose_or_Adho_Mukha_Svanasana_': 1,
'Intense_Side_Stretch_Pose_or_Parsvottanasana_': 1,
                   
'Half_Moon_Pose_or_Ardha_Chandrasana_': 2,
'Extended_Revolved_Triangle_Pose_or_Utthita_Trikonasana_': 2,
'Extended_Revolved_Side_Angle_Pose_or_Utthita_Parsvakonasana_':2,
'Gate_Pose_or_Parighasana_': 2,
'Warrior_I_Pose_or_Virabhadrasana_I_': 2,
'viparita_virabhadrasana_or_reverse_warrior_pose': 2,
'Low_Lunge_pose_or_Anjaneyasana_': 2,
                   
'Warrior_II_Pose_or_Virabhadrasana_II_': 3,
'Warrior_III_Pose_or_Virabhadrasana_III_': 3,
'Lord_of_the_Dance_Pose_or_Natarajasana_': 3,                 
'Standing_big_toe_hold_pose_or_Utthita_Padangusthasana': 3,
'Standing_Split_pose_or_Urdhva_Prasarita_Eka_Padasana_': 3, 

# sitting
'Sitting pose 1 (normal)': 4,
'Bound_Angle_Pose_or_Baddha_Konasana_': 4,
'Garland_Pose_or_Malasana_': 4,
'Staff_Pose_or_Dandasana_': 4,
'Noose_Pose_or_Pasasana_': 4,

'Cow_Face_Pose_or_Gomukhasana_': 5, 
'Virasana_or_Vajrasana': 5,
"Bharadvaja's_Twist_pose_or_Bharadvajasana_I_": 5,
'Half_Lord_of_the_Fishes_Pose_or_Ardha_Matsyendrasana_': 5,
 
'Split pose': 6,
'Wide-Angle_Seated_Forward_Bend_pose_or_Upavistha_Konasana_': 6,
 
'Head-to-Knee_Forward_Bend_pose_or_Janu_Sirsasana_': 7,
'Revolved_Head-to-Knee_Pose_or_Parivrtta_Janu_Sirsasana_': 7,
'Seated_Forward_Bend_pose_or_Paschimottanasana_': 7,
'Tortoise_Pose': 7,
 
'Akarna_Dhanurasana': 8,
'Heron_Pose_or_Krounchasana_': 8,
'Rajakapotasana': 8,

# balancing
'Crane_(Crow)_Pose_or_Bakasana_': 9,
'Shoulder-Pressing_Pose_or_Bhujapidasana_': 9,
'Cockerel_Pose': 9,
'Scale_Pose_or_Tolasana_': 9,
'Firefly_Pose_or_Tittibhasana_': 9,

'Side_Crane_(Crow)_Pose_or_Parsva_Bakasana_': 10,
'Eight-Angle_Pose_or_Astavakrasana_': 10,
'Pose_Dedicated_to_the_Sage_Koundinya_or_Eka_Pada_Koundinyanasana_I_and_II': 10,

# inverted
'Handstand_pose_or_Adho_Mukha_Vrksasana_': 11,
'Supported_Headstand_pose_or_Salamba_Sirsasana_': 11,
'Supported_Shoulderstand_pose_or_Salamba_Sarvangasana_': 11,
'Feathered_Peacock_Pose_or_Pincha_Mayurasana_': 11,
'Legs-Up-the-Wall_Pose_or_Viparita_Karani_': 11,
 
'Plow_Pose_or_Halasana_': 12,
'Scorpion_pose_or_vrischikasana': 12,

# reclining
'Corpse_Pose_or_Savasana_': 13,
'Fish_Pose_or_Matsyasana_': 13,
'Happy_Baby_Pose_or_Ananda_Balasana_': 13,
'Reclining_Hand-to-Big-Toe_Pose_or_Supta_Padangusthasana_': 13,
'Wind_Relieving_pose_or_Pawanmuktasana': 13,
'Supta_Baddha_Konasana_': 13,
'Supta_Virasana_Vajrasana': 13,
'Yogic_sleep_pose': 13,
 
'Cobra_Pose_or_Bhujangasana_': 14,
'Frog_Pose_or_Bhekasana': 14,
'Locust_Pose_or_Salabhasana_': 14,
'Child_Pose_or_Balasana_': 14,
'Extended_Puppy_Pose_or_Uttana_Shishosana_': 14,

'Side-Reclining_Leg_Lift_pose_or_Anantasana_': 15,
'Side_Plank_Pose_or_Vasisthasana_': 15,
 
'Dolphin_Plank_Pose_or_Makara_Adho_Mukha_Svanasana_': 16,
'Four-Limbed_Staff_Pose_or_Chaturanga_Dandasana_': 16,
'Plank_Pose_or_Kumbhakasana_': 16,
'Peacock_Pose_or_Mayurasana_': 16,

# wheel
'Upward_Bow_(Wheel)_Pose_or_Urdhva_Dhanurasana_': 17,
'Upward_Facing_Two-Foot_Staff_Pose_or_Dwi_Pada_Viparita_Dandasana_': 17,
'Upward_Plank_Pose_or_Purvottanasana_': 17,
'Pigeon_Pose_or_Kapotasana_': 17,
'Bridge_Pose_or_Setu_Bandha_Sarvangasana_': 17,
'Wild_Thing_pose_or_Camatkarasana_': 17,
'Camel_Pose_or_Ustrasana_': 17,
 
'Cat_Cow_Pose_or_Marjaryasana_': 18,
 
'Boat_Pose_or_Paripurna_Navasana_': 19,
'Bow_Pose_or_Dhanurasana_': 19}


# mapeo de carpetas con su respectiva clase usando 6 clases
classes_level3 = {
# standing
'Eagle_Pose_or_Garudasana_': 0, 
'Tree_Pose_or_Vrksasana_': 0,
'Chair_Pose_or_Utkatasana_': 0,
                  
'Standing_Forward_Bend_pose_or_Uttanasana_': 0,
'Wide-Legged_Forward_Bend_pose_or_Prasarita_Padottanasana_': 0,
'Dolphin_Pose_or_Ardha_Pincha_Mayurasana_': 0,
'Downward-Facing_Dog_pose_or_Adho_Mukha_Svanasana_': 0,
'Intense_Side_Stretch_Pose_or_Parsvottanasana_': 0,
                   
'Half_Moon_Pose_or_Ardha_Chandrasana_': 0,
'Extended_Revolved_Triangle_Pose_or_Utthita_Trikonasana_': 0,
'Extended_Revolved_Side_Angle_Pose_or_Utthita_Parsvakonasana_': 0,
'Gate_Pose_or_Parighasana_': 0,
'Warrior_I_Pose_or_Virabhadrasana_I_': 0,
'viparita_virabhadrasana_or_reverse_warrior_pose': 0,
'Low_Lunge_pose_or_Anjaneyasana_': 0,
                   
'Warrior_II_Pose_or_Virabhadrasana_II_': 0,
'Warrior_III_Pose_or_Virabhadrasana_III_': 0,
'Lord_of_the_Dance_Pose_or_Natarajasana_': 0,                 
'Standing_big_toe_hold_pose_or_Utthita_Padangusthasana': 0,
'Standing_Split_pose_or_Urdhva_Prasarita_Eka_Padasana_': 0, 

# sitting
'Sitting pose 1 (normal)': 1,
'Bound_Angle_Pose_or_Baddha_Konasana_': 1,
'Garland_Pose_or_Malasana_': 1,
'Staff_Pose_or_Dandasana_': 1,
'Noose_Pose_or_Pasasana_': 1,

'Cow_Face_Pose_or_Gomukhasana_': 1, 
'Virasana_or_Vajrasana': 1,
"Bharadvaja's_Twist_pose_or_Bharadvajasana_I_": 1,
'Half_Lord_of_the_Fishes_Pose_or_Ardha_Matsyendrasana_': 1,
 
'Split pose': 1,
'Wide-Angle_Seated_Forward_Bend_pose_or_Upavistha_Konasana_': 1,
 
'Head-to-Knee_Forward_Bend_pose_or_Janu_Sirsasana_': 1,
'Revolved_Head-to-Knee_Pose_or_Parivrtta_Janu_Sirsasana_': 1,
'Seated_Forward_Bend_pose_or_Paschimottanasana_': 1,
'Tortoise_Pose': 1,
 
'Akarna_Dhanurasana': 1,
'Heron_Pose_or_Krounchasana_': 1,
'Rajakapotasana': 1,

# balancing
'Crane_(Crow)_Pose_or_Bakasana_': 2,
'Shoulder-Pressing_Pose_or_Bhujapidasana_': 2,
'Cockerel_Pose': 2,
'Scale_Pose_or_Tolasana_': 2,
'Firefly_Pose_or_Tittibhasana_': 2,

'Side_Crane_(Crow)_Pose_or_Parsva_Bakasana_': 2,
'Eight-Angle_Pose_or_Astavakrasana_': 2,
'Pose_Dedicated_to_the_Sage_Koundinya_or_Eka_Pada_Koundinyanasana_I_and_II': 2,

# inverted
'Handstand_pose_or_Adho_Mukha_Vrksasana_': 3,
'Supported_Headstand_pose_or_Salamba_Sirsasana_': 3,
'Supported_Shoulderstand_pose_or_Salamba_Sarvangasana_': 3,
'Feathered_Peacock_Pose_or_Pincha_Mayurasana_': 3,
'Legs-Up-the-Wall_Pose_or_Viparita_Karani_': 3,
 
'Plow_Pose_or_Halasana_': 3,
'Scorpion_pose_or_vrischikasana': 3,

# reclining
'Corpse_Pose_or_Savasana_': 4,
'Fish_Pose_or_Matsyasana_': 4,
'Happy_Baby_Pose_or_Ananda_Balasana_': 4,
'Reclining_Hand-to-Big-Toe_Pose_or_Supta_Padangusthasana_': 4,
'Wind_Relieving_pose_or_Pawanmuktasana': 4,
'Supta_Baddha_Konasana_': 4,
'Supta_Virasana_Vajrasana': 4,
'Yogic_sleep_pose': 4,
 
'Cobra_Pose_or_Bhujangasana_': 4,
'Frog_Pose_or_Bhekasana': 4,
'Locust_Pose_or_Salabhasana_': 4,
'Child_Pose_or_Balasana_': 4,
'Extended_Puppy_Pose_or_Uttana_Shishosana_': 4,

'Side-Reclining_Leg_Lift_pose_or_Anantasana_': 4,
'Side_Plank_Pose_or_Vasisthasana_': 4,
 
'Dolphin_Plank_Pose_or_Makara_Adho_Mukha_Svanasana_': 4,
'Four-Limbed_Staff_Pose_or_Chaturanga_Dandasana_': 4,
'Plank_Pose_or_Kumbhakasana_': 4,
'Peacock_Pose_or_Mayurasana_': 4,

# wheel
'Upward_Bow_(Wheel)_Pose_or_Urdhva_Dhanurasana_': 5,
'Upward_Facing_Two-Foot_Staff_Pose_or_Dwi_Pada_Viparita_Dandasana_': 5,
'Upward_Plank_Pose_or_Purvottanasana_': 5,
'Pigeon_Pose_or_Kapotasana_': 5,
'Bridge_Pose_or_Setu_Bandha_Sarvangasana_': 5,
'Wild_Thing_pose_or_Camatkarasana_': 5,
'Camel_Pose_or_Ustrasana_': 5,
 
'Cat_Cow_Pose_or_Marjaryasana_': 5,
 
'Boat_Pose_or_Paripurna_Navasana_': 5,
'Bow_Pose_or_Dhanurasana_': 5}


from torchvision import datasets

# dataset que lee las imagenes del conjunto de datos
# y realiza el mapeo de su clase segun el nivel de jerarquia usado
def YogaDataset(dir = 'Images',
                transform = None, 
                level = 1):
  
  # se lee la carpeta con imagenes
  data = datasets.ImageFolder(dir,
                              transform=transform,
                              target_transform=target_mapping(level=level)
                              )
  return data

# clase llamable que permite, dado un nivel de jerarquia,
# obtener el indice de la clase que le corresponde a una imagen
class target_mapping():
    def __init__(self, level):
        # se entrega el nivel
        self.level = level
        
    def __call__(self, x):
      # caso en que se ocupan las 82 clases
      if self.level == 1:
        return x
      # caso en que se ocupan 20 clases
      elif self.level == 2:
        return classes_level2[list(classes_level1.keys())[x]]
      # caso en que se ocupan 6 clases
      elif self.level == 3:
        return classes_level3[list(classes_level1.keys())[x]]